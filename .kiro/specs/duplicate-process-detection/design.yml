metadata:
  title: 多重実行プロセスの検出 - 設計書
  feature: duplicate-process-detection
  status: draft
  created: 2025-11-29
  updated: 2025-11-29

correctness-properties:
  - id: P1
    title: プロセスカウントの正確性
    type: invariant
    description: '*任意の*プロセスリストについて、同一スクリプトのプロセス数は実際の実行数と一致すること'
    validates:
      - AC-001
    test-strategy: property-based
  
  - id: P2
    title: 閾値判定の正確性
    type: invariant
    description: '*任意の*閾値Tとプロセス数Nについて、N >= Tの場合のみ警告対象となること'
    validates:
      - AC-002
    test-strategy: property-based
  
  - id: P3
    title: スクリプト名抽出の正確性
    type: invariant
    description: '*任意の*コマンドライン形式について、対象拡張子(.py, .sh等)を持つスクリプト名が正しく抽出されること'
    validates:
      - AC-001
    test-strategy: property-based
  
  - id: P4
    title: 助言メッセージの完全性
    type: invariant
    description: '*任意の*多重実行検出について、スクリプト名、実行数、推奨アクションを含むメッセージが生成されること'
    validates:
      - AC-003
    test-strategy: property-based
  
  - id: P5
    title: 設定値の検証
    type: invariant
    description: '*任意の*閾値設定について、1以上の整数のみが許可され、無効な値はデフォルト値(3)にフォールバックすること'
    validates:
      - AC-004
    test-strategy: property-based
  
  - id: P6
    title: 既存機能への影響なし
    type: invariant
    description: '*任意の*多重実行検出機能について、既存のKomon機能が正常に動作し、全ての既存テストがパスすること'
    validates:
      - AC-005
    test-strategy: integration
