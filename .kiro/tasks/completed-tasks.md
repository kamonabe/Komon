---
title: Komon - Completed Tasks Archive
status: archive
created: 2025-11-26
updated: 2025-12-01
---

# Komon 完了タスクアーカイブ

このファイルは、`implementation-tasks.md`から移動した完了済みタスクを保存します。

## アーカイブルール

- 次のバージョンがリリースされたら、前バージョンの完了タスクをここに移動
- バージョン降順で整理（新しいものが上）
- 直近バージョンの完了タスクは`implementation-tasks.md`に残す

---

## [v1.27.0] 完了タスク

### [TASK-020] Webhook通知統一化 Phase 2: 統一Webhook実装
**元アイデア**: [IDEA-023] Webhook通知の統一化（Phase 2）  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 中（4-5時間）  
**完了日**: 2025-12-19 (v1.27.0)

#### 背景
新しい統一Webhook方式を追加。旧方式（個別関数）も完全に動作し、フォールバックとして機能する。

#### 実装内容
- ✅ `WebhookNotifier`クラスによる統一通知インターフェース
- ✅ サービス別フォーマッター（Slack、Discord、Teams、汎用）
- ✅ 新旧形式の完全な互換性（フォールバック機能）
- ✅ 複数通知サービスの一元管理
- ✅ 設定ファイルに`notifiers.webhooks`セクションを追加
- ✅ 全通知スクリプトに統一Webhook機能を統合
- ✅ 50件以上のテストケース追加（ユニット・統合・フォーマッター）
- ✅ サービス別の最適化されたメッセージフォーマット
- ✅ エラーハンドリングと詳細な送信結果レポート

#### 期待効果
- 統一されたWebhook通知インターフェース
- 複数通知サービスの一元管理
- 完全な後方互換性とフォールバック機能
- 高品質なテストカバレッジ（90%維持）

---

## [v1.26.0] 完了タスク

### [TASK-019] Webhook通知統一化 Phase 1: Discord/Teams対応
**元アイデア**: [IDEA-023] Webhook通知の統一化（Phase 1）  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-12-12 (v1.26.0)

#### 背景
既存のSlack通知と同じ形式で、Discord/Teams通知を追加する。既存のSlack通知には一切触らず、新規機能として追加することでリスクを最小化。

#### 実装内容
- ✅ Discord/Teams通知関数の追加
- ✅ 設定ファイルの拡張
- ✅ 全通知スクリプトへの統合
- ✅ 30件のテストケース追加
- ✅ ドキュメント更新

#### 期待効果
- Discord/Teamsユーザーも同じ通知を受信可能
- 既存のSlack通知との完全な互換性
- 環境変数による安全な認証情報管理

---

## [v1.25.0] 完了タスク

### [TASK-023] ネットワーク疎通チェック機能（ping/http）
**元アイデア**: [IDEA-024] ネットワーク疎通チェック機能（ping/http）  
**feature-name**: network-connectivity-check  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 中（6-8時間）  
**完了日**: 2025-12-08 (v1.25.0)

#### 背景
REST API実行前の事前条件確認や外部通信不可時の早期気づきのため、ネットワーク疎通の軽量チェック機能を追加。

#### 実装内容
- ✅ ping疎通チェック（ICMPエコー）
- ✅ http疎通チェック（GET/HEAD/POSTメソッド対応）
- ✅ CLI引数（`--with-net`, `--net-only`, `--ping-only`, `--http-only`）
- ✅ 状態変化時のみ通知
- ✅ NG状態のretention機能
- ✅ 43件のテストケース追加

#### 期待効果
- REST API実行前の事前条件確認が可能
- 外部通信不可時の早期気づき
- opt-in設計により既存ユーザーへの影響ゼロ

---

## [v1.24.0] 完了タスク

### [TASK-018] OS判定・汎用Linux対応（マルチディストリビューション対応）
**元アイデア**: [IDEA-022] OS判定・汎用Linux対応  
**feature-name**: os-detection-multi-distro  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（4-6時間）  
**完了日**: 2025-12-03 (v1.24.0)

#### 背景
現在のKomonはRHEL系を想定して設計されているが、Debian系でも動作する可能性がある。「誤ったアドバイスをしない」という哲学を守るため、OS判定機能が必要。

#### 実装内容
- ✅ OS自動判定機能（rhel/debian/suse/arch/unknown）
- ✅ OS別アドバイス出し分け
- ✅ Debian系でのパッケージ系アドバイス抑制
- ✅ ログパス切替（/var/log/messages vs /var/log/syslog）
- ✅ Windows非対応の明示、WSL対応
- ✅ 36件のテストケース追加

#### 期待効果
- Raspberry Pi等での誤動作防止
- 「誤ったアドバイスをしない」という一貫性の維持
- 将来的な他ディストリビューション対応の基盤

---

## [v1.20.0] 完了タスク

### [TASK-006] 多重実行プロセスの検出
**元アイデア**: [IDEA-011] 多重実行プロセスの検出  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 中（3-4時間）  
**完了日**: 2025-11-29 (v1.20.0)

#### 背景
cronなどによる同一スクリプトの多重起動を検出し、リソース圧迫の原因として助言。

#### 実装内容
- ✅ `duplicate_detector.py`モジュールの作成
- ✅ 多重実行検出ロジック
- ✅ 設定で閾値を変更可能
- ✅ 27件のテストケース追加（ユニット・統合・プロパティ）
- ✅ 対象拡張子: .py, .sh, .rb, .pl

#### 期待効果
- cronによる多重実行の早期発見
- リソース圧迫の原因特定
- システム安定性の向上

---

## [v1.23.0] 完了タスク

### [TASK-017] `komon advise` 出力フォーマットの改善
**元アイデア**: [IDEA-021] `komon advise` 出力フォーマットの改善  
**feature-name**: advise-output-improvement  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-12-02 (v1.23.0)

#### 背景
ユーザーからのフィードバック：「`komon advise` を見た時に『で？今のCPU/Mem/Diskはいくつなの？』って思った」

**現状の問題点**:
- ❌ 最も重要な情報（現在のリソース使用率）が表示されていない
- ❌ 過去の警告履歴ばかりが表示される
- ❌ 「データ不足」というノイズが多い
- ❌ 情報密度が高すぎて重要な情報が埋もれる
- ❌ CPU/メモリ0.0%のプロセスが表示される（意味がない）

#### タスク分解
- [x] プログレスバー生成関数の実装
- [x] 状態判定関数の実装
- [x] システム状態表示関数の実装
- [x] 出力順序の変更
- [x] ノイズの削減
- [x] オプション対応（`--verbose`, `--section`, `--history N`）
- [x] 設定ファイル対応
- [x] テストケースの追加
- [x] ドキュメント更新

#### 完了条件
- ✅ 現在のシステム状態が最初に表示される
- ✅ プログレスバーで視覚的に分かりやすい
- ✅ 閾値も数値で明確に表示される
- ✅ 警告時は上位プロセスも表示される
- ✅ ノイズが削減される
- ✅ 通知履歴の重複が減る（デフォルト5件）
- ✅ オプションで詳細表示が可能
- ✅ 設定ファイルでカスタマイズ可能
- ✅ 全436テストがパス
- ✅ カバレッジを維持

#### 期待効果
- ✅ 「今、システムは大丈夫か？」が一目で分かる
- ✅ 視覚的に分かりやすい（プログレスバー）
- ✅ 閾値も明確（数値表示）
- ✅ 情報密度が適切
- ✅ ノイズが減る

---

## [v1.22.0] 完了タスク

### [TASK-005] 継続実行中プロセスの検出
**元アイデア**: [IDEA-010] 継続実行中プロセスの検出  
**feature-name**: long-running-detector  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 中（4-5時間）  
**完了日**: 2025-12-01 (v1.22.0)

#### 背景
特定スクリプトがまだ終了していない場合に、継続稼働を助言表示。

#### タスク分解
- [x] `src/komon/long_running_detector.py` モジュールの作成
- [x] `scripts/advise.py` の拡張
- [x] 設定ファイルの拡張
- [x] テストケースの追加
- [x] ドキュメント更新

#### 完了条件
- ✅ 長時間実行中のスクリプトが検出される
- ✅ `komon advise` で表示される
- ✅ 設定で対象スクリプトを指定できる
- ✅ 全419テストがパス
- ✅ カバレッジ92%を維持

#### 実装詳細
- `long_running_detector.py`: 長時間実行プロセス検出ロジック
- `advise.py`: 警告表示機能
- `settings.yml.sample`: 設定項目の追加
- デフォルト閾値: 3600秒（1時間）
- 対象拡張子: .py, .sh, .rb, .pl

#### 依存関係
- なし

---

## [v1.21.0] 完了タスク

### [TASK-007] ログ急増時の末尾抜粋表示
**元アイデア**: [IDEA-012] ログ急増時の末尾抜粋表示  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-11-30 (v1.21.0)

#### 背景
ログ急増の通知時、行数だけでなく実際のログ末尾も数行添付。

#### タスク分解
- [x] `src/komon/log_tail_extractor.py` モジュールの作成
  - ログファイルの末尾N行を効率的に抽出
  - 長い行を切り詰める機能
  - エラーハンドリング
- [x] `scripts/main_log_monitor.py` を拡張
  - ログ急増検出時に末尾を抽出
  - 通知メッセージにコードブロック形式で追加
- [x] 設定ファイルの拡張
  - `log_analysis.tail_lines` を追加（デフォルト: 10）
  - `log_analysis.max_line_length` を追加（デフォルト: 500）
- [x] テストケースの追加
  - プロパティテスト: 3件
  - 統合テスト: 6件
  - ユニットテスト: 8件
- [x] ドキュメント更新
  - README.md に機能説明を追加
  - CHANGELOG.md に変更内容を記録

#### 完了条件
- ✅ ログ急増通知に末尾抜粋が含まれる
- ✅ 設定で行数を変更できる
- ✅ 既存機能に影響がない
- ✅ 全396テストがパス
- ✅ カバレッジ92%を維持

#### 実装詳細
- `log_tail_extractor.py`: ログ末尾抽出ロジック
- `main_log_monitor.py`: 通知メッセージへの統合
- `settings.yml.sample`: 設定項目の追加
- 大きなファイルでも高速動作（末尾のみ読み込み）

#### 依存関係
- なし

---

## [v1.19.0] 完了タスク

### [TASK-004] Slack通知にプロセス名を含める
**元アイデア**: [IDEA-009] Slack通知にプロセス名を含める  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-11-28 (v1.19.0)

#### 背景
Slack通知で、どのプロセスが高負荷を引き起こしているのかが一目で分かるようにする。

#### タスク分解
- [x] `scripts/main.py` の通知処理を拡張
  - CPU/メモリ超過時に上位プロセス情報を取得
  - メッセージフォーマットに追加
- [x] `src/komon/monitor.py` のプロセス情報取得を活用
- [x] Slackメッセージフォーマットの調整
  - 上位3プロセスを表示
  - プロセス名と使用率を含める
- [x] テストケースの追加
  - プロセス情報付き通知のユニットテスト: 10件
  - プロセス情報付き通知の統合テスト: 3件
- [x] ドキュメント更新（README.md, CHANGELOG.md）

#### 完了条件
- ✅ Slack通知に上位プロセス情報が含まれる
- ✅ 既存の通知機能に影響がない
- ✅ テストが追加され、カバレッジ93%を維持
- ✅ CPU/メモリの上位3プロセス情報が正しく表示される
- ✅ ディスクの場合はプロセス情報が表示されない

#### 実装詳細
- `scripts/main.py` の `handle_alerts()` 関数を拡張
- `_get_process_info_for_metric()` 関数を新規追加
- CPU: プロセス名と使用率（%）を表示
- メモリ: プロセス名と使用量（MB）を表示
- ディスク: プロセス情報は表示しない（取得困難なため）
- 全352テストがパス、カバレッジ93%を維持

#### 依存関係
- TASK-003と並行実装可能（同じプロセス情報取得ロジックを共有）

---

## [v1.18.0] 完了タスク

### [TASK-003] コンテキストに応じた具体的アドバイス
**元アイデア**: [IDEA-003] コンテキストに応じた具体的アドバイス  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 大（8-12時間）  
**完了日**: 2025-11-27 (v1.18.0)

#### 背景
現状は「メモリ使用率が高いです」と伝えるだけ。プロセス情報に基づいて具体的なアクションを提案する。

#### タスク分解
- [x] プロセス情報の取得強化
  - `src/komon/contextual_advisor.py` を新規作成
  - 上位3-5プロセスを特定
- [x] パターンマッチングロジックの実装
  - プロセス名からパターン認識（node, docker, python等）
  - 各パターンに対応する提案テンプレート
- [x] 提案メッセージテンプレートの作成
  - node系: 開発サーバー停止の提案
  - docker系: 不要コンテナの確認提案
  - python系: 学習プロセスの確認提案
  - その他多数のパターンを定義
- [x] `scripts/advise.py` に提案ロジックを統合
- [x] 設定ファイルで提案の詳細度を調整可能に
  - `settings.yml` に `contextual_advice` セクションを追加
  - `advice_level: minimal/normal/detailed` を実装
- [x] テストケースの追加
  - プロパティベーステスト: 5件
  - ユニットテスト: 25件
  - 統合テスト: 11件
- [x] ドキュメント更新（README.md, CHANGELOG.md）

#### 完了条件
- ✅ 閾値超過時に上位プロセスと具体的な提案が表示される
- ✅ パターン認識が正しく機能する
- ✅ 設定で詳細度を変更できる
- ✅ 既存テストが全てPASS（315テスト）
- ✅ カバレッジ93%を維持

#### 実装詳細
- `src/komon/contextual_advisor.py` を新規作成（103行）
- `scripts/advise.py` に `advise_contextual()` 関数を追加
- `config/settings.yml.sample` に `contextual_advice` セクションを追加
- プロパティベーステスト5件、ユニットテスト25件、統合テスト11件を追加
- 全315テストがパス、カバレッジ93%を維持

#### 依存関係
- なし（独立して実装可能）

---

## [v1.16.0] 完了タスク

### [TASK-015] ディスク使用量の増加トレンド予測
**元アイデア**: [IDEA-017] ディスク使用量の増加トレンド予測  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（6-8時間）  
**完了日**: 2025-11-25 (v1.16.0)

#### 背景
84%から90%に一気にジャンプするケースがあり、
「このままだと○日後に100%になる」という予測があると事前対応できる。

#### タスク分解
- [x] 過去7日分のディスク使用率データの取得
  - `data/usage_history/` から履歴データを読み込み
  - 日次の平均値を計算
- [x] 線形回帰による増加率計算
  - 最小二乗法で傾きを算出
  - 90%到達予測日を計算
- [x] 急激な変化の検出
  - 前日比+10%以上の場合は警告
  - 「通常と異なる急激な増加」を通知
- [x] 予測メッセージの生成
  - 増加トレンドの説明
  - 90%到達予測日
  - 推奨コマンド（ログクリーンアップ等）
- [x] `scripts/advise.py` または週次レポートに統合
  - `komon advise` で予測を表示
  - 週次レポートにも含める
- [x] テストケースの追加
  - 線形回帰計算のテスト
  - 予測日計算のテスト
  - 急激な変化検出のテスト
- [x] ドキュメント更新
  - 使い方の説明
  - CHANGELOG.md に記録

#### 完了条件
- ✅ 過去7日分のデータから増加率を計算できる
- ✅ 90%到達予測日が正確に算出される
- ✅ 急激な変化が検出される
- ✅ `komon advise` で予測が表示される
- ✅ 既存テストが全てPASS（238テスト、カバレッジ94%）

#### 実装詳細
- `src/komon/disk_predictor.py` を新規作成
- `scripts/advise.py` に`advise_disk_prediction()`関数を追加
- `src/komon/weekly_data.py` の`collect_weekly_data()`にディスク予測を統合
- `src/komon/report_formatter.py` に`format_disk_prediction()`関数を追加
- プロパティベーステスト8件、ユニットテスト17件、統合テスト5件を追加
- 全238テストがパス、カバレッジ94%を維持

#### 期待効果
- 事前の計画的な対応が可能
- 急激な変化の早期検知
- 「あと○日で危険」という具体的な情報

#### 依存関係
- なし（独立して実装可能）

---

## [v1.15.0] 完了タスク

### [TASK-014] 通知頻度制御（同一アラートの抑制）
**元アイデア**: [IDEA-016] 通知頻度制御（同一アラートの抑制）  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（5-7時間）  
**完了日**: 2025-11-24 (v1.15.0)

#### 背景
現状は5分おきにcronが動いており、閾値を超え続けると5分おきに通知が飛ぶ。
「はいはい、いつものやつね」となって見なくなる（オオカミ少年化）リスクがある。

#### タスク分解
- [x] 通知履歴に最終通知時刻を記録
  - `data/notifications/throttle.json` に保存
  - メトリクスタイプ（CPU/MEM/DISK）ごとに管理
- [x] `src/komon/notification.py` に抑制ロジック追加
  - 前回通知からの経過時間を計算
  - 設定された間隔未満なら通知を抑制
  - 閾値レベルが上がった場合は即座に通知（85%→90%等）
- [x] `settings.yml` に通知頻度制御設定を追加
  - `throttle.enabled`: 有効/無効
  - `throttle.interval_minutes`: 通知間隔（デフォルト: 60分）
  - `throttle.escalation_minutes`: 再通知間隔（デフォルト: 180分）
- [x] エスカレーション機能の実装
  - 長時間継続する問題の再通知
  - 「○時間経過しましたが、まだ高い状態が続いています」
- [x] テストケースの追加
  - 通知抑制のテスト
  - エスカレーションのテスト
  - 閾値レベル変化時の即時通知テスト
- [x] ドキュメント更新
  - 設定例の追加
  - CHANGELOG.md に記録

#### 完了条件
- ✅ 同一アラートが設定間隔で抑制される
- ✅ 閾値レベルが上がった場合は即座に通知される
- ✅ エスカレーション機能が正しく動作する
- ✅ 既存テストが全てPASS（189テスト）

#### 実装詳細
- `src/komon/notification.py` - NotificationThrottleクラスを追加
- `src/komon/analyzer.py` - analyze_usage_with_levels()関数を追加
- `scripts/main.py` - 通知頻度制御を統合
- プロパティベーステスト4件、ユニットテスト15件、統合テスト8件を追加
- 全189テストがパス

#### 期待効果
- 通知疲れの防止
- 重要な通知を見逃さない
- 長時間継続する問題の再通知

#### 依存関係
- TASK-013（段階的閾値）と組み合わせると効果的

---

## [v1.14.0] 完了タスク

### [TASK-016] セキュリティドキュメントの充実
**元アイデア**: Kiroからの弱点分析に基づく改善  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-11-23 (v1.14.0)

#### 背景
現状の`SECURITY.md`は簡素すぎて、実用的なセキュリティガイダンスが不足している。
認証情報の管理、ファイルパーミッション、cron実行時のセキュリティなど、
実運用で必要な情報を充実させる。

#### タスク分解
- [x] `docs/SECURITY.md` の大幅拡充
  - 認証情報の管理（Webhook URL、メールパスワード）
  - ファイルパーミッションの設定
  - cron実行時のセキュリティ
  - ログファイルアクセス権限
  - 依存パッケージの管理
  - ネットワークセキュリティ
  - データ保護
  - 最小権限の原則
- [x] 環境変数対応の強化
  - Slack Webhook URLの環境変数読み込み機能追加
  - `src/komon/notification.py` を修正
- [x] 設定ファイルサンプルの更新
  - `config/settings.yml.sample` に環境変数の使い方を明記
- [x] セキュリティチェックリストの追加
- [x] 定期メンテナンスガイドの追加

#### 完了条件
- ✅ `SECURITY.md` が実用的な内容に拡充されている
- ✅ 環境変数からの読み込みがSlack/メール両方で機能する
- ✅ セキュリティベストプラクティスが明確に記載されている
- ✅ 既存機能に影響がない

#### 実装詳細
- `docs/SECURITY.md` を約10倍のボリュームに拡充
- `src/komon/notification.py` にSlack Webhook URLの環境変数対応を追加
- `config/settings.yml.sample` を更新

#### 期待効果
- 本番環境での安全な運用が可能に
- 認証情報漏洩リスクの低減
- セキュリティ意識の向上

#### 依存関係
- なし（独立して実装可能）

---

## [v1.13.0] 完了タスク

### [TASK-013] 段階的な閾値通知（警告→警戒→緊急）
**元アイデア**: [IDEA-015] 段階的な閾値通知（警告→警戒→緊急）  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（5-7時間）  
**完了日**: 2025-11-23 (v1.13.0)

#### 背景
現状は単一の閾値（ディスク80%）で通知するだけ。
84%から90%に一気にジャンプするケース（Firewallログの大量取り込み等）があり、
段階的な通知で早期に気づきたい。

#### タスク分解
- [x] `settings.yml` の閾値設定を拡張
  - 3段階の閾値設定（warning/alert/critical）
  - 既存の単一閾値設定との後方互換性を維持
- [x] `src/komon/settings_validator.py` の新規作成
  - 閾値設定の検証と正規化
  - ThresholdLevel列挙型の定義
- [x] `src/komon/analyzer.py` の判定ロジックを3段階に変更
  - 各段階での判定処理
  - 段階に応じたメッセージ生成
- [x] 段階別メッセージテンプレートの作成
  - 警告（70%）: 「そろそろ気にかけておいた方がいいかも」
  - 警戒（80%）: 「ちょっと気になる水準です」
  - 緊急（90%）: 「かなり逼迫しています！」
- [x] 絵文字の使い分け
  - 💛 警告（黄色）
  - 🧡 警戒（オレンジ）
  - ❤️ 緊急（赤）
- [x] テストケースの追加
  - プロパティベーステスト3件
  - ユニットテスト12件
  - 統合テスト8件
- [x] ドキュメント更新
  - README.mdに設定例を追加
  - CHANGELOG.md に記録

#### 完了条件
- ✅ 3段階の閾値判定が正しく機能する
- ✅ 既存の単一閾値設定でも動作する（後方互換性）
- ✅ 段階に応じたメッセージが表示される
- ✅ 全160テストがPASS、カバレッジ93%

#### 実装詳細
- `src/komon/settings_validator.py` を新規作成
- プロパティベーステスト3件、ユニットテスト12件、統合テスト8件を追加
- 全160テストがパス、カバレッジ93%を維持

#### 期待効果
- 急激な変化に対する早期警戒
- 段階的な対応が可能（70%で準備、90%で緊急対応）
- 「オオカミ少年」にならない適切な警告レベル

#### 依存関係
- TASK-014（通知頻度制御）と組み合わせると効果的

---

## [v1.12.0] 完了タスク

### [TASK-012] 定期健全性レポート（週次）
**元アイデア**: [IDEA-014] 定期健全性レポート（週次）  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（6-8時間）  
**完了日**: 2025-11-22 (v1.12.0)

#### 背景
年末年始など長期休暇前に「システムが健全かどうか」を確認したいが、
毎回サーバにSSHで入って確認するのは手間がかかる。
異常がなくても定期的に状況を把握できる仕組みが必要。

#### タスク分解
- [x] 新規スクリプト `scripts/weekly_report.py` の作成
  - 過去7日分のリソースデータを集計
  - 先週比の計算ロジック
  - 通知履歴から警戒情報を抽出
- [x] レポートメッセージフォーマットの設計
  - リソース状況（CPU/メモリ/ディスク）
  - 先週比の増減
  - 今週の警戒情報サマリー
  - トレンド判定（安定/増加傾向/減少傾向）
- [x] 設定ファイルへの追加
  - `settings.yml` に週次レポート設定を追加
  - 有効/無効の切り替え
  - 送信曜日・時刻の設定
- [x] Slack/メール通知との統合
- [x] cron設定例の追加
  - `0 9 * * 1` (毎週月曜9時)
- [x] テストケースの追加
  - データ集計のテスト
  - 先週比計算のテスト
  - メッセージ生成のテスト
- [x] ドキュメント更新
  - README.md に使い方を追加
  - cron設定例を追加
  - CHANGELOG.md に記録

#### 完了条件
- ✅ 週次レポートが正しく生成される
- ✅ 先週比の計算が正確
- ✅ Slack/メールで送信できる
- ✅ cron設定で自動実行できる
- ✅ 既存テストが全てPASS（150テスト、カバレッジ92%）

#### 実装詳細
- `src/komon/weekly_data.py` を新規作成
- `src/komon/report_formatter.py` を新規作成
- `scripts/weekly_report.py` を新規作成
- プロパティベーステスト6件、統合テスト6件、ユニットテスト26件を追加
- 全150テストがパス

#### 期待効果
- サーバにログインせずにSlackで健全性確認
- 異常がなくても「見守られている」安心感
- 長期休暇前の確認作業が楽になる

#### 依存関係
- なし（独立して実装可能）

---

## [v1.11.0] 完了タスク

### [TASK-002] ローカル通知履歴の保存と表示
**元アイデア**: [IDEA-008] ローカル通知履歴の保存と表示  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（5-7時間）  
**完了日**: 2025-11-22 (v1.11.0)

#### 背景
Slack等の通知が使えない環境でも、Komonが検知した情報を後から確認できるようにする。

#### タスク分解
- [x] 通知記録ファイルの設計
  - ファイルパス: `notifications/queue.json`
  - データ構造の定義
  - 最大保存件数: 100件
- [x] `src/komon/notification.py` に保存処理を追加
  - 通知送信時に自動保存
  - 上限超過時の古いデータ削除ロジック
- [x] `scripts/advise.py` に表示処理を統合
  - デフォルト: 全履歴を表示
  - オプション: `--history N` で直近N件を表示
- [x] 表示フォーマットの設計
  - タイムスタンプ、メトリクスタイプ、値、メッセージ
- [x] テストケースの追加
  - 保存処理のテスト
  - 上限超過時の削除テスト
  - 表示処理のテスト
- [x] ドキュメント更新
  - README.md に使い方を追加
  - CHANGELOG.md に記録

#### 完了条件
- ✅ 通知が自動的にローカルファイルに保存される
- ✅ `komon advise` で履歴が表示される
- ✅ 最大100件の制限が機能する
- ✅ 既存機能に影響がない

#### 実装詳細
- `src/komon/notification_history.py` を新規作成
- プロパティベーステスト7件、統合テスト6件、ユニットテスト5件を追加
- 全111テストがパス

#### 依存関係
- なし（独立して実装可能）

---

## [v1.17.0] 完了タスク

### [TASK-001] 段階的な通知メッセージの実装
**元アイデア**: [IDEA-001] 通知メッセージの改善  
**ステータス**: 🟢 Done  
**優先度**: High  
**見積もり**: 中（4-6時間）  
**完了日**: 2025-11-26 (v1.17.0)

#### 背景
v1.10.1で通知メッセージの口調改善は完了。次のステップとして、通知履歴を持って段階的な表現を切り替える仕組みを実装する。

#### タスク分解
- [x] 通知履歴を活用する仕組みの設計
  - 既存の通知履歴機能（v1.11.0）を活用
  - 保存場所: `data/notifications/queue.json`
  - 保存内容: タイムスタンプ、通知タイプ、メトリクス値
- [x] 履歴から同一問題の繰り返し回数を判定するロジック
  - 時間窓: 直近24時間以内
  - 同一問題の定義: 同じメトリクスタイプ（CPU/メモリ/ディスク）
- [x] 段階的メッセージテンプレートの作成
  - 1回目: 「ちょっと気になることがあります」
  - 2回目: 「まだ続いてますね」
  - 3回目以降: 「そろそろ見た方がいいかも」
- [x] `src/komon/progressive_message.py` の作成
- [x] `src/komon/analyzer.py` の修正
- [x] テストケースの追加
  - プロパティベーステスト: 5件
  - ユニットテスト: 19件
  - 統合テスト: 6件
- [x] ドキュメント更新（README.md, CHANGELOG.md）

#### 完了条件
- ✅ 同一問題が繰り返し発生した際、段階的に表現が変わる
- ✅ 既存テストが全てPASS（268テスト）
- ✅ 新規テストが追加され、カバレッジ93%を維持

#### 実装詳細
- `src/komon/progressive_message.py` を新規作成
- `src/komon/analyzer.py` に`use_progressive`パラメータを追加
- `config/settings.yml.sample` に`progressive_notification`セクションを追加
- プロパティベーステスト5件、ユニットテスト19件、統合テスト6件を追加
- 全268テストがパス、カバレッジ93%を維持

#### 依存関係
- なし（独立して実装可能）

---

## 更新履歴

- 2025-12-03: v1.23.0の完了タスクを移動（TASK-017）
- 2025-12-02: v1.22.0の完了タスクを移動（TASK-005）
- 2025-12-01: v1.21.0の完了タスクを移動（TASK-007）
- 2025-11-29: v1.19.0の完了タスクを移動（TASK-004）
- 2025-11-29: v1.18.0の完了タスクを移動（TASK-003）
- 2025-11-27: v1.17.0の完了タスクを移動（TASK-001）
- 2025-11-26: アーカイブファイル作成、v1.11.0〜v1.16.0の完了タスクを移動
