---
title: Komon - Implementation Task List
status: active
created: 2025-11-22
updated: 2025-11-26
---

# Komon 実装タスクリスト

このドキュメントは、`specs/future-ideas.md` のアイデアを実装可能なタスクに分解し、進捗を管理します。

**注意**: 完了したタスク（v1.17.0以前）は `completed-tasks.md` に移動されています。

---

## タスクステータス

- 🔴 **TODO**: 未着手
- 🟡 **In Progress**: 実装中
- 🟢 **Done**: 完了
- ⏸️ **On Hold**: 保留中
- ❌ **Cancelled**: キャンセル

---

## 🔥 High Priority Tasks

### [TASK-017] `komon advise` 出力フォーマットの改善
**元アイデア**: [IDEA-021] `komon advise` 出力フォーマットの改善  
**feature-name**: advise-output-improvement  
**ステータス**: � DoDne  
**優先度**: High  
**見積もり**: 小（2-3時間）  
**完了日**: 2025-12-02 (v1.23.0)

#### 背景
ユーザーからのフィードバック：「`komon advise` を見た時に『で？今のCPU/Mem/Diskはいくつなの？』って思った」

**現状の問題点**:
- ❌ 最も重要な情報（現在のリソース使用率）が表示されていない
- ❌ 過去の警告履歴ばかりが表示される
- ❌ 「データ不足」というノイズが多い
- ❌ 情報密度が高すぎて重要な情報が埋もれる
- ❌ CPU/メモリ0.0%のプロセスが表示される（意味がない）

#### タスク分解
- [x] プログレスバー生成関数の実装
  - `generate_progress_bar(percent, width=10)` 関数
  - 10%刻みで視覚的に表示
- [x] 状態判定関数の実装
  - `get_status_info(value, thresholds)` 関数
  - 正常/警告/危険の判定とアイコン表示
- [x] システム状態表示関数の実装
  - `display_system_status()` 関数
  - CPU/メモリ/ディスクの現在値を最初に表示
  - 警告時は上位プロセスも表示
- [x] 出力順序の変更
  - システム状態を最初に表示
  - 警戒情報、改善提案、通知履歴の順
- [x] ノイズの削減
  - 「データ不足」メッセージの簡潔化
  - CPU/メモリ0.0%のプロセスを非表示
  - 通知履歴のデフォルト件数を5件に制限
- [x] オプション対応
  - `--verbose` オプションの実装
  - `--section` オプションの実装
  - `--history N` オプションの実装
- [x] 設定ファイル対応
  - `output` セクションの追加
  - `default_mode`, `history_limit`, `show_zero_cpu` 等
- [x] テストケースの追加
  - ユニットテスト: プログレスバー生成、状態判定
  - 統合テスト: 出力フォーマット全体
- [x] ドキュメント更新
  - README.md の使用例を更新
  - CHANGELOG.md の更新

#### 完了条件
- ✅ 現在のシステム状態が最初に表示される
- ✅ プログレスバーで視覚的に分かりやすい
- ✅ 閾値も数値で明確に表示される
- ✅ 警告時は上位プロセスも表示される
- ✅ ノイズが削減される（データ不足、0.0%プロセス）
- ✅ 通知履歴の重複が減る（デフォルト5件）
- ✅ `--verbose` オプションで詳細表示が可能
- ✅ `--section` オプションで特定セクションのみ表示が可能
- ✅ 設定ファイルで出力フォーマットをカスタマイズ可能
- ✅ 全436テストがパス
- ✅ カバレッジを維持

#### 実装イメージ
```
📊 現在のシステム状態
CPU:     [████░░░░░░] 12.3% / 80% ✅
メモリ:  [████████░░] 45.2% / 85% ✅
ディスク: [██████████] 67.8% / 90% ⚠️

🔔 警戒情報（なし）

💡 改善提案
✅ セキュリティパッチ: なし
✅ システムパッチ: 最新

⏱️  長時間実行プロセス
⚠️ shellIntegration-bash.sh (1時間2分)

📜 通知履歴（最新5件）
💿 [12:51:44] DISK: 96.7% - 警戒
📊 [12:51:44] MEMORY: 91.3% - 警戒
🔥 [12:51:44] CPU: 88.5% - 警戒

詳細: komon advise --verbose
```

#### 期待効果
- ✅ 「今、システムは大丈夫か？」が一目で分かる
- ✅ 視覚的に分かりやすい（プログレスバー）
- ✅ 閾値も明確（数値表示）
- ✅ 情報密度が適切（重要な情報が埋もれない）
- ✅ ノイズが減る（データ不足、0.0%プロセス）
- ✅ 通知履歴の重複が減る（デフォルト5件）

#### 依存関係
- なし（既存機能の改善）

---

## 💡 Medium Priority Tasks

### [TASK-006] 多重実行プロセスの検出
**元アイデア**: [IDEA-011] 多重実行プロセスの検出  
**ステータス**: 🟢 Done  
**優先度**: Medium  
**見積もり**: 中（3-4時間）  
**完了日**: 2025-11-29 (v1.20.0)

#### 背景
cronなどによる同一スクリプトの多重起動を検出し、リソース圧迫の原因として助言。

#### タスク分解
- [x] `src/komon/duplicate_detector.py` モジュールの作成
  - `detect_duplicate_processes()` 関数の実装
  - `_extract_script_name()` 関数の実装
  - エラーハンドリングとログ出力
- [x] `scripts/advise.py` の拡張
  - `advise_duplicate_processes()` 関数の追加
  - メイン処理への統合
- [x] 設定ファイルの拡張
  - `duplicate_process_detection` セクションの追加
  - 閾値と有効/無効の設定
- [x] テストケースの追加
  - ユニットテスト: 15件
  - 統合テスト: 7件
  - プロパティテスト: 5件
- [x] ドキュメント更新
  - README.md の機能一覧に追加
  - CHANGELOG.md の更新

#### 完了条件
- ✅ 同一スクリプトの多重実行が検出される
- ✅ 設定で閾値を変更できる
- ✅ テストが追加され、全379テストがパス
- ✅ カバレッジ93%を維持
- ✅ `komon advise` で警告が表示される

#### 実装詳細
- `duplicate_detector.py`: 多重実行検出ロジック
- `advise.py`: 警告表示機能
- `settings.yml.sample`: 設定項目の追加
- 対象拡張子: .py, .sh, .rb, .pl
- デフォルト閾値: 3個以上

#### 依存関係
- TASK-005と並行実装可能（同じプロセス走査ロジックを共有）

---

## 🔮 Low Priority / Future Tasks

### [TASK-008] 学習機能（パターン認識）
**元アイデア**: [IDEA-002] 学習機能（パターン認識）  
**ステータス**: ⏸️ On Hold  
**優先度**: Low  
**見積もり**: 大（20時間以上）

#### 背景
ユーザーの行動パターンを学習して、不要な通知を減らす。

#### 検討事項
- 実装難易度が高い
- Komonの「シンプル」思想と相反する可能性
- まずは他の高優先度タスクを完了させてから検討

---

### [TASK-009] 週次レポート機能
**元アイデア**: [IDEA-004] 週次レポート機能  
**ステータス**: 🔴 TODO  
**優先度**: Low  
**見積もり**: 中（6-8時間）

#### 背景
週に1回、振り返りレポートを送信。

#### タスク分解（概要のみ）
- [ ] 週次データの集計ロジック
- [ ] レポートメッセージの作成
- [ ] cron設定の追加
- [ ] 設定で有効/無効を切り替え可能に

---

### [TASK-010] トレンド予測機能
**元アイデア**: [IDEA-007] トレンド予測機能  
**ステータス**: 🔴 TODO  
**優先度**: Low  
**見積もり**: 大（10-15時間）

#### 背景
過去のトレンドから将来を予測。

#### 検討事項
- 予測アルゴリズムの精度が課題
- まずは基本機能を充実させてから検討

---

### [TASK-011] トップ3増加ログの可視化
**元アイデア**: [IDEA-013] トップ3増加ログの可視化  
**ステータス**: 🔴 TODO  
**優先度**: Low  
**見積もり**: 中（5-7時間）

#### 背景
ログ傾向分析の結果を「通知」だけでなく「魅せる」方向へ進化。

#### 検討事項
- matplotlib依存の追加が必要
- Komonの「軽量」思想とのバランスを考慮

---

## 実装ワークフロー

```
1. future-ideas.md でアイデアを検討
   ↓
2. 実装を決定したら、このファイルにタスク化
   ↓
3. タスクステータスを更新しながら実装
   ↓
4. テスト・レビュー
   ↓
5. ステータスを 🟢 Done に更新
   ↓
6. CHANGELOG.md に記録
   ↓
7. future-ideas.md のステータスを「実装済み」に更新
```

---

## 優先順位の判断基準

**High Priority**:
- ユーザー体験を大きく改善する
- 実装コストが低〜中程度
- Komonの思想を強化する
- 既存機能との親和性が高い

**Medium Priority**:
- 便利だが必須ではない
- 実装コストが中程度
- 特定のユースケースで有用

**Low Priority**:
- 実装コストが高い
- 効果が不確実
- まずは他の機能を優先すべき

---

## アーカイブルール

- 次のバージョンがリリースされたら、前バージョンの完了タスクを `completed-tasks.md` に移動
- 直近バージョン（v1.18.0）の完了タスクはこのファイルに残す
- アーカイブは `completed-tasks.md` でバージョン降順に整理

## 更新履歴

- 2025-12-02: TASK-017を追加（IDEA-021: `komon advise` 出力フォーマットの改善）
- 2025-12-02: v1.22.0の完了タスクを `completed-tasks.md` に移動（TASK-005）
- 2025-12-01: v1.21.0の完了タスクを `completed-tasks.md` に移動（TASK-007）
- 2025-11-29: v1.19.0の完了タスクを `completed-tasks.md` に移動（TASK-004）
- 2025-11-29: v1.18.0の完了タスクを `completed-tasks.md` に移動（TASK-003）
- 2025-11-28: TASK-004を完了に更新（v1.19.0）
- 2025-11-27: v1.17.0の完了タスクを `completed-tasks.md` に移動（TASK-001）
- 2025-11-27: TASK-003を完了に更新（v1.18.0）
- 2025-11-26: タスクリストをアーカイブ方式に変更、v1.16.0以前の完了タスクを `completed-tasks.md` に移動
- 2025-11-26: TASK-001を完了に更新（v1.17.0）
- 2025-11-25: TASK-015を完了に更新（v1.16.0）
- 2025-11-24: TASK-014を完了に更新（v1.15.0）
- 2025-11-23: TASK-016を完了に更新（v1.14.0）
- 2025-11-23: TASK-013を完了に更新（v1.13.0）
- 2025-11-22: 年末年始の健全確認対応として4タスクを追加（TASK-012〜015）
- 2025-11-22: TASK-002を完了に更新（v1.11.0）
- 2025-11-22: 初版作成（future-ideas.md から11タスクを抽出）
